<% content_for :show_additional_content do %>
  <div class="mb-5 color-bg-surface-default border color-border-default rounded " aria-expanded="false" data-accordion="open" id="<%= "#{Deal.model_name.human(count: 2).downcase}-#{@product.class.name.downcase}" %>-section">
    <header class="flex flex-wrap items-center justify-between gap-2 p-4">
      <div class='flex items-center gap-2'>
        <i data-lucide="clipboard-list" class='color-fg-default stroke-1.04 w-5 h-5'></i>
        <h1 class='color-fg-default typography-sub-title-900 '>
          <%= Deal.model_name.human(count: 2) %>
        </h1>
      </div>
      <div class='flex items-center gap-2'>
        <button type="button" class="button-default-blank-secondary-icon-only-sm" data-accordion-target="#accordion-collapse-<%= "#{Deal.model_name.human(count: 2)}-#{@product.class.name.downcase}-#{@product.object_id}"%>" aria-expanded="true" aria-controls="accordion-collapse-<%= "#{Deal.model_name.human(count: 2)}-#{@product.class.name.downcase}-#{@product.object_id}"%>">
          <i data-accordion-icon data-lucide="chevron-down" class="rotate-180 shrink-0" height="16"></i>
        </button>
      </div>
    </header>
    <ul class="p-4 flex flex-col gap-2 border-t color-border-default" id="accordion-collapse-<%= "#{Deal.model_name.human(count: 2)}-#{@product.class.name.downcase}-#{@product.object_id}"%>" aria-labelledby="accordion-collapse-heading-<%= "#{Deal.model_name.human(count: 2)}-#{@product.class.name.downcase}-#{@product.object_id}"%>">
      <% @product.deal_products.each do |deal_product| %>
        <%= content_tag :li, id: dom_id(deal_product.deal), class: "grid gap-5 border-b-2 border-light-palette-p3 last:border-none py-5 first:pt-0 last:pb-0", data: {controller: 'load-lucid-icons'} do %>
          <div class= "flex items-center gap-4">
            <div class="h-10 w-10 flex items-center justify-center rounded-lg border-2 border-light-palette-p3 typography-text-m-lh150 text-dark-gray-palette-p3  dark:text-gray-200">
              <i data-lucide="clipboard-list" class='w-5 h-5'></i>
            </div>
            <div class="mr-auto">
              <div class="flex flex-col">
                <h2 class="typography-text-s-lh150 text-dark-gray-palette-p1">
                  <%= deal_product.deal.name %>
                </h2>
                <div class="flex items-center gap-1.5 typography-sub-text-r-lh150 text-dark-gray-palette-p4">
                  <span>
                    <%= "#{t('activerecord.attributes.deal_product.quantity')}: #{deal_product.quantity}" %>
                  </span>
                  <span>|</span>
                  <%= render 'components/formatters/currency', value: deal_product.total_amount_in_cents %>
                </div>
              </div>
            </div>
            <%= link_to account_deal_path(Current.account, deal_product.deal.id ), data: {turbo_frame: :_top} , class: 'flex items-center justify-center rounded text-gray-pallete-p3 w-8 h-8 hover:bg-light-palette-p4 hover:text-dark-gray-palette-p1 dark:hover:bg-gray-600 dark:hover:text-white' do %>
              <i data-lucide="arrow-right"></i>
            <% end %>
          </li>
        <% end %>
      <% end %>
    </ul>
  </div>
<% end %>
<% content_for :sidebar do %>
  <%= render 'components/show_model/sidebar', model: @product,
      links: [
        { label: t('activerecord.models.show'), icon: "info" },
        { label: t('activerecord.models.deal.other'), icon: "clipboard-list" }
      ] %>
<% end %>
<%= render 'components/show_model/show_model', model: @product %>
